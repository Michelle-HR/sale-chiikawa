<!DOCTYPE html>
<html lang="zh-TW">
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <head>
  <meta charset="UTF-8" />
  <title>äºŒæ‰‹äº¤æ˜“å¹³å°</title>
  <style>
    body { font-family: Arial; background:#f5f5f5; padding:20px; }
    h1 { text-align:center; }
    .container { display:flex; gap:20px; }
    .box { background:#fff; padding:15px; border-radius:8px; width:50%; }
    img { width:100%; max-height:200px; object-fit:cover; }
    button { margin-top:10px; padding:8px 12px; cursor:pointer; }
    select, input { width:100%; margin-top:8px; padding:6px; }
    .item { border-bottom:1px solid #ddd; margin-bottom:10px; padding-bottom:10px; }
  </style>
</head>
<body>

<h1>ğŸ›’ äºŒæ‰‹äº¤æ˜“ç¶²ç«™</h1>

<div class="container">

  <!-- ä¸Šæ¶å•†å“ -->
  <div class="box">
    <h3>ä¸Šæ¶å•†å“</h3>
    <input type="text" id="name" placeholder="å•†å“åç¨±">
    <input type="number" id="price" placeholder="åƒ¹æ ¼">
    <input type="file" id="photo">
    <select id="place">
      <option>åœ‹å£½ä»æ„›å¤§æ¨“</option>
      <option>åœ‹å£½ä¿¡ç¾©å®‰å’Œå¤§æ¨“</option>
      <option>åœ‹å£½å…§æ¹–å¤§æ¨“</option>
      <option>éŠ€è¡Œæ¾ä»å¤§æ¨“</option>
      <option>è­‰åˆ¸æ•¦å—å¤§æ¨“</option>
    </select>
    <button onclick="addItem()">ä¸Šæ¶</button>
  </div>

  <!-- å•†å“åˆ—è¡¨ -->
  <div class="box">
    <h3>å•†å“åˆ—è¡¨</h3>
    <div id="items"></div>
  </div>

</div>

<script>
   apiKey: "AIzaSyC-uOHBAqCsdZkvqisND_0JgR5govDqMZY",
    authDomain: "sale-chiikawa.firebaseapp.com",
    projectId: "sale-chiikawa",
    storageBucket: "sale-chiikawa.firebasestorage.app",
    messagingSenderId: "22981104406",
    appId: "1:22981104406:web:7c094b64fc1877c6d1f637"
  };

  // åˆå§‹åŒ– Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const itemsBox = document.getElementById("items");

  // æ–°å¢å•†å“
  function addItem() {
    const name = document.getElementById("name").value;
    const price = document.getElementById("price").value;
    const seller = document.getElementById("seller").value;
    const contact = document.getElementById("contact").value;
    const place = document.getElementById("place").value;
    const photoInput = document.getElementById("photo");

    if (!name || !price || !seller || !contact || !photoInput.files[0]) {
      alert("è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½");
      return;
    }

    const reader = new FileReader();
    reader.onload = function () {
      db.collection("items").add({
        name,
        price,
        seller,
        contact,
        place,
        img: reader.result,
        createdAt: new Date()
      }).then(() => {
        alert("å•†å“å·²ä¸Šæ¶ï¼");
        renderItems();
      });
    };
    reader.readAsDataURL(photoInput.files[0]);
  }

  // é¡¯ç¤ºæ‰€æœ‰å•†å“ï¼ˆæ‰€æœ‰äººå…±ç”¨ï¼‰
  function renderItems() {
    itemsBox.innerHTML = "";
    db.collection("items")
      .orderBy("createdAt", "desc")
      .get()
      .then(snapshot => {
        snapshot.forEach(doc => {
          const i = doc.data();
          itemsBox.innerHTML += `
            <div class="item">
              <img src="${i.img}">
              <b>${i.name}</b><br>
              åƒ¹æ ¼ï¼š$${i.price}<br>
              è³£å®¶ï¼š${i.seller}<br>
              è¯ç¹«æ–¹å¼ï¼š${i.contact}<br>
              äº¤æ˜“åœ°é»ï¼š${i.place}<br>
            </div>
          `;
        });
      });
  }

  renderItems();
</script>

</body>
</html>
