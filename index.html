<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>äºŒæ‰‹äº¤æ˜“å¹³å°</title>

  <!-- Firebase SDKï¼ˆcompat ç‰ˆï¼Œé©åˆç´” HTMLï¼‰ -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .container {
      display: flex;
      gap: 20px;
    }
    .box {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      width: 50%;
    }
    input, select, button {
      width: 100%;
      margin-top: 8px;
      padding: 6px;
      font-size: 14px;
    }
    button {
      cursor: pointer;
    }
    img {
      width: 100%;
      max-height: 200px;
      object-fit: cover;
      margin-bottom: 6px;
    }
    .item {
      border-bottom: 1px solid #ddd;
      margin-bottom: 12px;
      padding-bottom: 12px;
    }
  </style>
</head>

<body>

<h1>ğŸ›’ äºŒæ‰‹äº¤æ˜“ç¶²ç«™</h1>

<div class="container">

  <!-- ä¸Šæ¶å•†å“ -->
  <div class="box">
    <h3>ä¸Šæ¶å•†å“</h3>

    <input type="text" id="name" placeholder="å•†å“åç¨±">
    <input type="number" id="price" placeholder="åƒ¹æ ¼">
    <input type="text" id="seller" placeholder="è³£å®¶åå­—">
    <input type="text" id="contact" placeholder="è¯ç¹«æ–¹å¼ï¼ˆLine / Emailï¼‰">
    <input type="file" id="photo">

    <select id="place">
      <option>åœ‹å£½ä»æ„›å¤§æ¨“</option>
      <option>åœ‹å£½ä¿¡ç¾©å®‰å’Œå¤§æ¨“</option>
      <option>åœ‹å£½å…§æ¹–å¤§æ¨“</option>
      <option>éŠ€è¡Œæ¾ä»å¤§æ¨“</option>
      <option>è­‰åˆ¸æ•¦å—å¤§æ¨“</option>
    </select>

    <button onclick="addItem()">ä¸Šæ¶</button>
  </div>

  <!-- å•†å“åˆ—è¡¨ -->
  <div class="box">
    <h3>å•†å“åˆ—è¡¨</h3>
    <div id="items"></div>
  </div>

</div>

<script>
  /* ğŸ”¥ Firebase è¨­å®šï¼ˆå·²å¹«ä½ æ•´ç†å¥½ï¼‰ */
const firebaseConfig = {
    apiKey: "AIzaSyC-uOHBAqCsdZkvqisND_0JgR5govDqMZY",
    authDomain: "sale-chiikawa.firebaseapp.com",
    projectId: "sale-chiikawa",
    storageBucket: "sale-chiikawa.firebasestorage.app",
    messagingSenderId: "22981104406",
    appId: "1:22981104406:web:7c094b64fc1877c6d1f637"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
</script>

  const itemsBox = document.getElementById("items");

  /* æ–°å¢å•†å“ */
  function addItem() {
    const name = document.getElementById("name").value.trim();
    const price = document.getElementById("price").value;
    const seller = document.getElementById("seller").value.trim();
    const contact = document.getElementById("contact").value.trim();
    const place = document.getElementById("place").value;
    const photoInput = document.getElementById("photo");

    if (!name || !price || !seller || !contact || !photoInput.files[0]) {
      alert("è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½");
      return;
    }

    const reader = new FileReader();
    reader.onload = function () {
      db.collection("items").add({
        name,
        price,
        seller,
        contact,
        place,
        img: reader.result,
        createdAt: new Date()
      }).then(() => {
        // æ¸…ç©ºè¡¨å–®
        document.getElementById("name").value = "";
        document.getElementById("price").value = "";
        document.getElementById("seller").value = "";
        document.getElementById("contact").value = "";
        document.getElementById("photo").value = "";
      });
    };
    reader.readAsDataURL(photoInput.files[0]);
  }

  /* å³æ™‚é¡¯ç¤ºæ‰€æœ‰å•†å“ï¼ˆå¤šäººåŒæ­¥ï¼‰ */
  function renderItems() {
    db.collection("items")
      .orderBy("createdAt", "desc")
      .onSnapshot(snapshot => {
        itemsBox.innerHTML = "";
        snapshot.forEach(doc => {
          const i = doc.data();
          itemsBox.innerHTML += `
            <div class="item">
              <img src="${i.img}">
              <b>${i.name}</b><br>
              åƒ¹æ ¼ï¼š$${i.price}<br>
              è³£å®¶ï¼š${i.seller}<br>
              è¯ç¹«æ–¹å¼ï¼š${i.contact}<br>
              äº¤æ˜“åœ°é»ï¼š${i.place}<br>
            </div>
          `;
        });
      });
  }

  renderItems();
</script>

</body>
</html>
